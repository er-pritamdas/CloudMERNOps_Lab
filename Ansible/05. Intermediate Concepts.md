# ðŸ“˜ **Section 4: Intermediate Concepts in Ansible**

This section moves beyond the basics and covers the **real-world Ansible features** that interviewers love to ask about.

---

## ðŸ”¹ 4.1 **Templates (Jinja2)**

Templates let you create **dynamic configuration files** using variables.

Ansible uses **Jinja2 templating** (similar to Django/Flask templating).

**Example Template (nginx.conf.j2):**

```jinja
server {
  listen 80;
  server_name {{ server_name }};
  root {{ document_root }};
}
```

**Playbook Using Template:**

```yaml
- hosts: web
  vars:
    server_name: example.com
    document_root: /var/www/html
  tasks:
    - name: Deploy nginx config
      template:
        src: nginx.conf.j2
        dest: /etc/nginx/conf.d/nginx.conf
      notify: Restart nginx
```

ðŸ‘‰ Interview Q: *Whatâ€™s the difference between `copy` and `template`?*

* `copy` â†’ Copies a static file.
* `template` â†’ Processes variables/placeholders dynamically.

---

## ðŸ”¹ 4.2 **Roles**

Roles = **modular way to organize playbooks** (reusable units).

**Role Structure:**

```text
my-role/
  tasks/main.yml
  handlers/main.yml
  templates/
  files/
  vars/main.yml
  defaults/main.yml
```

**Using a Role:**

```yaml
- hosts: web
  roles:
    - my-role
```

ðŸ‘‰ Interview Q: *When do you use roles?*

* For large projects, roles bring  **reusability, readability, and modularity** .

---

## ðŸ”¹ 4.3 **Ansible Vault**

Vault is used to **encrypt sensitive data** (like passwords, API keys).

**Encrypt a file:**

```bash
ansible-vault create secrets.yml
```

**Edit a vault file:**

```bash
ansible-vault edit secrets.yml
```

**Run playbook with vault password:**

```bash
ansible-playbook site.yml --ask-vault-pass
```

ðŸ‘‰ Interview Q: *How do you store DB passwords securely in Ansible?*

* Use **Ansible Vault** to encrypt and reference them in playbooks.

---

## ðŸ”¹ 4.4 **Tags**

Tags let you run **only specific tasks** from a playbook.

**Example:**

```yaml
- hosts: web
  tasks:
    - name: Install Apache
      yum:
        name: httpd
        state: present
      tags: apache

    - name: Install MySQL
      yum:
        name: mariadb
        state: present
      tags: mysql
```

**Run only MySQL tasks:**

```bash
ansible-playbook site.yml --tags mysql
```

ðŸ‘‰ Interview Q: *When are tags useful?*

* Large playbooks where you want to run only a subset of tasks.

---

## ðŸ”¹ 4.5 **Lookups**

Lookups fetch data from outside sources (files, environment variables, commands).

**Examples:**

```yaml
- hosts: all
  tasks:
    - name: Read a file
      debug:
        msg: "{{ lookup('file', '/etc/hostname') }}"

    - name: Use environment variable
      debug:
        msg: "{{ lookup('env', 'HOME') }}"
```

ðŸ‘‰ Interview Q: *Whatâ€™s the use of `lookup` in Ansible?*

* To fetch external data (file, env vars, secret managers, etc.) into playbooks.

---

# âœ… **Interview Checkpoints (Section 4)**

* **Template vs Copy module.**
* **Role structure** and why we use roles.
* **How to secure secrets** (Vault).
* **Use of tags** (run specific tasks).
* **Lookups** (fetching external data).

---
