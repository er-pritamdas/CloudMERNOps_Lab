
# ðŸ“˜ Section 4: Docker Volumes & Storage

## 4.1 Why Storage is Needed?

* By default,  **container data is temporary** .
* Example:
  <pre class="overflow-visible!" data-start="339" data-end="506"><div class="contain-inline-size rounded-2xl relative bg-token-sidebar-surface-primary"><div class="sticky top-9"><div class="absolute end-0 bottom-0 flex h-9 items-center pe-2"><div class="bg-token-bg-elevated-secondary text-token-text-secondary flex items-center gap-4 rounded-sm px-2 font-sans text-xs"></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="whitespace-pre! language-bash"><span><span>docker run -it ubuntu bash
  </span><span>echo</span><span></span><span>"hello"</span><span> > /data.txt
  </span><span>exit</span><span>
  docker start -ai <container>
  </span><span>cat</span><span> /data.txt   </span><span># File may be gone if container recreated</span><span>
  </span></span></code></div></div></pre>

ðŸ‘‰ To persist data beyond the containerâ€™s lifecycle â†’ use **Volumes** or  **Bind Mounts** .

---

## 4.2 Types of Storage in Docker

| Storage Type           | Description                                      | Use Case                                            |
| ---------------------- | ------------------------------------------------ | --------------------------------------------------- |
| **Volumes**      | Managed by Docker (`/var/lib/docker/volumes/`) | Persistent DB storage, preferred for portability    |
| **Bind Mounts**  | Link host directory â†’ container directory       | Useful for dev (sync code between host & container) |
| **tmpfs Mounts** | Data stored in memory (not disk)                 | Sensitive data, cache, improves speed               |

---

## 4.3 Volumes

### Creating & Managing Volumes

<pre class="overflow-visible!" data-start="1106" data-end="1268"><div class="contain-inline-size rounded-2xl relative bg-token-sidebar-surface-primary"><div class="sticky top-9"><div class="absolute end-0 bottom-0 flex h-9 items-center pe-2"><div class="bg-token-bg-elevated-secondary text-token-text-secondary flex items-center gap-4 rounded-sm px-2 font-sans text-xs"></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="whitespace-pre! language-bash"><span><span>docker volume create myvolume
docker volume </span><span>ls</span><span>
docker volume inspect myvolume
docker volume </span><span>rm</span><span> myvolume
docker volume prune    </span><span># Remove unused volumes</span><span>
</span></span></code></div></div></pre>

### Using Volumes in Containers

<pre class="overflow-visible!" data-start="1302" data-end="1351"><div class="contain-inline-size rounded-2xl relative bg-token-sidebar-surface-primary"><div class="sticky top-9"><div class="absolute end-0 bottom-0 flex h-9 items-center pe-2"><div class="bg-token-bg-elevated-secondary text-token-text-secondary flex items-center gap-4 rounded-sm px-2 font-sans text-xs"></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="whitespace-pre! language-bash"><span><span>docker run -d -v myvolume:/data nginx
</span></span></code></div></div></pre>

* Mounts volume `myvolume` to `/data` in container.
* Data persists even if container is deleted.

ðŸ“Œ Test:

<pre class="overflow-visible!" data-start="1464" data-end="1680"><div class="contain-inline-size rounded-2xl relative bg-token-sidebar-surface-primary"><div class="sticky top-9"><div class="absolute end-0 bottom-0 flex h-9 items-center pe-2"><div class="bg-token-bg-elevated-secondary text-token-text-secondary flex items-center gap-4 rounded-sm px-2 font-sans text-xs"></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="whitespace-pre! language-bash"><span><span>docker run -it -v myvolume:/app ubuntu bash
</span><span>echo</span><span></span><span>"Hello World"</span><span> > /app/file.txt
</span><span>exit</span><span>

</span><span># Run another container using same volume</span><span>
docker run -it -v myvolume:/app ubuntu bash
</span><span>cat</span><span> /app/file.txt   </span><span># Hello World</span><span>
</span></span></code></div></div></pre>

---

## 4.4 Bind Mounts

* Mounts a **host directory/file** into the container.
* Syntax:

  <pre class="overflow-visible!" data-start="1776" data-end="1844"><div class="contain-inline-size rounded-2xl relative bg-token-sidebar-surface-primary"><div class="sticky top-9"><div class="absolute end-0 bottom-0 flex h-9 items-center pe-2"><div class="bg-token-bg-elevated-secondary text-token-text-secondary flex items-center gap-4 rounded-sm px-2 font-sans text-xs"></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="whitespace-pre! language-bash"><span><span>docker run -v /path/on/host:/path/in/container image
  </span></span></code></div></div></pre>
* Example:

  <pre class="overflow-visible!" data-start="1858" data-end="1941"><div class="contain-inline-size rounded-2xl relative bg-token-sidebar-surface-primary"><div class="sticky top-9"><div class="absolute end-0 bottom-0 flex h-9 items-center pe-2"><div class="bg-token-bg-elevated-secondary text-token-text-secondary flex items-center gap-4 rounded-sm px-2 font-sans text-xs"></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="whitespace-pre! language-bash"><span><span>docker run -d -p 8080:80 -v $(</span><span>pwd</span><span>)/site:/usr/share/nginx/html nginx
  </span></span></code></div></div></pre>

  â†’ Edits in `./site` (host) instantly reflect inside Nginx.

---

## 4.5 tmpfs Mounts (In-Memory Storage)

* Stored in **RAM only** (not written to disk).
* Example:

  <pre class="overflow-visible!" data-start="2112" data-end="2178"><div class="contain-inline-size rounded-2xl relative bg-token-sidebar-surface-primary"><div class="sticky top-9"><div class="absolute end-0 bottom-0 flex h-9 items-center pe-2"><div class="bg-token-bg-elevated-secondary text-token-text-secondary flex items-center gap-4 rounded-sm px-2 font-sans text-xs"></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="whitespace-pre! language-bash"><span><span>docker run -d --tmpfs /app/cache:rw,size=64m nginx
  </span></span></code></div></div></pre>

  â†’ Mounts `/app/cache` in memory, limited to 64MB.

---

## 4.6 Inspecting Storage

<pre class="overflow-visible!" data-start="2263" data-end="2370"><div class="contain-inline-size rounded-2xl relative bg-token-sidebar-surface-primary"><div class="sticky top-9"><div class="absolute end-0 bottom-0 flex h-9 items-center pe-2"><div class="bg-token-bg-elevated-secondary text-token-text-secondary flex items-center gap-4 rounded-sm px-2 font-sans text-xs"></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="whitespace-pre! language-bash"><span><span>docker inspect <container_id>   </span><span># Look for "Mounts" section</span><span>
docker volume inspect <volume_name>
</span></span></code></div></div></pre>

---

## 4.7 Volume Drivers (Advanced)

* Default = local driver.
* Plugins available for NFS, GlusterFS, Ceph, cloud storage.
* Example:
  <pre class="overflow-visible!" data-start="2514" data-end="2667"><div class="contain-inline-size rounded-2xl relative bg-token-sidebar-surface-primary"><div class="sticky top-9"><div class="absolute end-0 bottom-0 flex h-9 items-center pe-2"><div class="bg-token-bg-elevated-secondary text-token-text-secondary flex items-center gap-4 rounded-sm px-2 font-sans text-xs"></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="whitespace-pre! language-bash"><span><span>docker volume create --driver </span><span>local</span><span> --opt </span><span>type</span><span>=nfs \
    --opt o=addr=192.168.1.100,rw \
    --opt device=:/exported/path \
    nfsvolume
  </span></span></code></div></div></pre>

---

## 4.8 Best Practices

* Prefer **volumes** over bind mounts for production (better portability & security).
* Use **bind mounts** in development (live editing of code).
* Regularly **prune unused volumes** to free space.
* For databases: always mount volumes for persistence.

---

âœ… **Summary of Section 4**

* Containers are ephemeral â†’ use  **volumes, bind mounts, tmpfs** .
* **Volumes** = best for persistent data.
* **Bind mounts** = great for dev (sync host files).
* **tmpfs** = in-memory, secure, fast.
* Volumes can be managed with `docker volume` commands.

---

ðŸ‘‰ Do you want me to now prepare a **command reference table (like in**
