# ðŸ“˜ Section 6: Docker Compose

## 6.1 What is Docker Compose?

* **Docker Compose** is a tool to  **define and manage multi-container Docker applications** .
* Instead of running multiple `docker run` commands, you define all containers in a **single YAML file** (`docker-compose.yml`).
* It handles **networks, volumes, dependencies, and scaling** automatically.

---

## 6.2 Installing Docker Compose

### On Linux

<pre class="overflow-visible!" data-start="558" data-end="629"><div class="contain-inline-size rounded-2xl relative bg-token-sidebar-surface-primary"><div class="sticky top-9"><div class="absolute end-0 bottom-0 flex h-9 items-center pe-2"><div class="bg-token-bg-elevated-secondary text-token-text-secondary flex items-center gap-4 rounded-sm px-2 font-sans text-xs"></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="whitespace-pre! language-bash"><span><span>sudo apt install docker-compose -y
docker-compose --version
</span></span></code></div></div></pre>

### On Windows/Mac

* Comes pre-installed with  **Docker Desktop** .
* Verify:

<pre class="overflow-visible!" data-start="708" data-end="744"><div class="contain-inline-size rounded-2xl relative bg-token-sidebar-surface-primary"><div class="sticky top-9"><div class="absolute end-0 bottom-0 flex h-9 items-center pe-2"><div class="bg-token-bg-elevated-secondary text-token-text-secondary flex items-center gap-4 rounded-sm px-2 font-sans text-xs"></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="whitespace-pre! language-bash"><span><span>docker-compose --version
</span></span></code></div></div></pre>

---

## 6.3 docker-compose.yml Structure

Basic structure:

<pre class="overflow-visible!" data-start="804" data-end="1289"><div class="contain-inline-size rounded-2xl relative bg-token-sidebar-surface-primary"><div class="sticky top-9"><div class="absolute end-0 bottom-0 flex h-9 items-center pe-2"><div class="bg-token-bg-elevated-secondary text-token-text-secondary flex items-center gap-4 rounded-sm px-2 font-sans text-xs"></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="whitespace-pre! language-yaml"><span><span>version:</span><span></span><span>"3.9"</span><span></span><span># Compose file version</span><span>

</span><span>services:</span><span></span><span># Define containers</span><span>
  </span><span>web:</span><span>
    </span><span>image:</span><span></span><span>nginx</span><span>
    </span><span>ports:</span><span>
      </span><span>-</span><span></span><span>"8080:80"</span><span>
    </span><span>volumes:</span><span>
      </span><span>-</span><span></span><span>./site:/usr/share/nginx/html</span><span>
  </span><span>app:</span><span>
    </span><span>build:</span><span></span><span>./app</span><span></span><span># Dockerfile directory</span><span>
    </span><span>environment:</span><span>
      </span><span>-</span><span></span><span>APP_ENV=prod</span><span>
    </span><span>depends_on:</span><span>
      </span><span>-</span><span></span><span>db</span><span>
  </span><span>db:</span><span>
    </span><span>image:</span><span></span><span>mysql:8</span><span>
    </span><span>environment:</span><span>
      </span><span>MYSQL_ROOT_PASSWORD:</span><span></span><span>root123</span><span>
    </span><span>volumes:</span><span>
      </span><span>-</span><span></span><span>db_data:/var/lib/mysql</span><span>

</span><span>volumes:</span><span></span><span># Named volumes</span><span>
  </span><span>db_data:</span><span>
</span></span></code></div></div></pre>

---

## 6.4 Key Sections in Compose File

| Section                       | Description                          | Example                            |
| ----------------------------- | ------------------------------------ | ---------------------------------- |
| **services**            | Defines all containers               | `web`,`app`,`db`             |
| **image**               | Pull pre-built image from Docker Hub | `nginx`                          |
| **build**               | Build image from local Dockerfile    | `build: ./app`                   |
| **ports**               | Expose container ports to host       | `"8080:80"`                      |
| **volumes**             | Mount host or named volume           | `- ./site:/usr/share/nginx/html` |
| **environment**         | Set env variables inside container   | `- APP_ENV=prod`                 |
| **depends_on**          | Define container startup order       | `depends_on: - db`               |
| **networks**            | Custom networks for containers       | `networks: - frontend`           |
| **volumes (top-level)** | Define persistent named volumes      | `db_data:`                       |

---

## 6.5 Common Docker Compose Commands

| Command                                 | Description                                                      |
| --------------------------------------- | ---------------------------------------------------------------- |
| `docker-compose up`                   | Start all services in the compose file                           |
| `docker-compose up -d`                | Run services in detached/background mode                         |
| `docker-compose down`                 | Stop and remove all containers, networks                         |
| `docker-compose build`                | Build or rebuild service images                                  |
| `docker-compose logs`                 | View combined logs from all services                             |
| `docker-compose logs -f`              | Follow logs in real-time                                         |
| `docker-compose ps`                   | List running services                                            |
| `docker-compose exec <service> <cmd>` | Execute command inside running service                           |
| `docker-compose stop`                 | Stop services without removing                                   |
| `docker-compose restart`              | Restart services                                                 |
| `docker-compose scale <service>=n`    | Scale services (deprecated in v3, use `replicas`in swarm mode) |

---

## 6.6 Networks in Compose

* By default, Compose creates a **single network** for all services in the file.
* Services can communicate via  **service name** .
* Custom network example:

<pre class="overflow-visible!" data-start="3057" data-end="3291"><div class="contain-inline-size rounded-2xl relative bg-token-sidebar-surface-primary"><div class="sticky top-9"><div class="absolute end-0 bottom-0 flex h-9 items-center pe-2"><div class="bg-token-bg-elevated-secondary text-token-text-secondary flex items-center gap-4 rounded-sm px-2 font-sans text-xs"></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="whitespace-pre! language-yaml"><span><span>networks:</span><span>
  </span><span>frontend:</span><span>
  </span><span>backend:</span><span>

</span><span>services:</span><span>
  </span><span>web:</span><span>
    </span><span>image:</span><span></span><span>nginx</span><span>
    </span><span>networks:</span><span>
      </span><span>-</span><span></span><span>frontend</span><span>
  </span><span>app:</span><span>
    </span><span>image:</span><span></span><span>myapp</span><span>
    </span><span>networks:</span><span>
      </span><span>-</span><span></span><span>frontend</span><span>
      </span><span>-</span><span></span><span>backend</span><span>
  </span><span>db:</span><span>
    </span><span>image:</span><span></span><span>mysql</span><span>
    </span><span>networks:</span><span>
      </span><span>-</span><span></span><span>backend</span><span>
</span></span></code></div></div></pre>

---

## 6.7 Volumes in Compose

* Named volumes are declared **top-level** and mounted into services:

<pre class="overflow-visible!" data-start="3394" data-end="3503"><div class="contain-inline-size rounded-2xl relative bg-token-sidebar-surface-primary"><div class="sticky top-9"><div class="absolute end-0 bottom-0 flex h-9 items-center pe-2"><div class="bg-token-bg-elevated-secondary text-token-text-secondary flex items-center gap-4 rounded-sm px-2 font-sans text-xs"></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="whitespace-pre! language-yaml"><span><span>volumes:</span><span>
  </span><span>db_data:</span><span>

</span><span>services:</span><span>
  </span><span>db:</span><span>
    </span><span>image:</span><span></span><span>mysql</span><span>
    </span><span>volumes:</span><span>
      </span><span>-</span><span></span><span>db_data:/var/lib/mysql</span><span>
</span></span></code></div></div></pre>

* Host paths can also be mounted:

<pre class="overflow-visible!" data-start="3538" data-end="3591"><div class="contain-inline-size rounded-2xl relative bg-token-sidebar-surface-primary"><div class="sticky top-9"><div class="absolute end-0 bottom-0 flex h-9 items-center pe-2"><div class="bg-token-bg-elevated-secondary text-token-text-secondary flex items-center gap-4 rounded-sm px-2 font-sans text-xs"></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="whitespace-pre! language-yaml"><span><span>volumes:</span><span>
  </span><span>-</span><span></span><span>./site:/usr/share/nginx/html</span><span>
</span></span></code></div></div></pre>

---

## 6.8 Scaling Services

* In v3+, scaling is mostly for **Docker Swarm** (`deploy.replicas`):

<pre class="overflow-visible!" data-start="3692" data-end="3767"><div class="contain-inline-size rounded-2xl relative bg-token-sidebar-surface-primary"><div class="sticky top-9"><div class="absolute end-0 bottom-0 flex h-9 items-center pe-2"><div class="bg-token-bg-elevated-secondary text-token-text-secondary flex items-center gap-4 rounded-sm px-2 font-sans text-xs"></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="whitespace-pre! language-yaml"><span><span>services:</span><span>
  </span><span>app:</span><span>
    </span><span>image:</span><span></span><span>myapp</span><span>
    </span><span>deploy:</span><span>
      </span><span>replicas:</span><span></span><span>3</span><span>
</span></span></code></div></div></pre>

* Compose v2 still supports `docker-compose up --scale app=3`.

---

âœ… **Summary of Section 6**

* Docker Compose simplifies  **multi-container apps** .
* YAML file defines  **services, networks, volumes, environment variables** .
* Commands like `up`, `down`, `logs`, `exec` manage containers.
* Compose handles networking and dependency automatically.

---

Do you want me to make a **Docker Compose che**
